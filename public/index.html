<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No Fa$t | Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        body { background: #050505; color: white; font-family: sans-serif; overflow-x: hidden; }
        .nav-glass { background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,0.1); }
        .animate-fade { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Custom scrollbar agar tetap estetik gelap */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 10px; }
    </style>
</head>
<body>
    <nav class="nav-glass sticky top-0 z-50 px-6 py-4 flex justify-between items-center">
        <div class="text-2xl font-black italic cursor-pointer tracking-tighter" onclick="loadPage('beranda')">
            NO <span class="text-blue-500">FA$T</span>
        </div>
        
        <div class="flex items-center gap-4">
            <button onclick="loadPage('katalog')" class="text-[10px] font-black uppercase tracking-widest border border-white/20 px-4 py-2 rounded-full hover:bg-white hover:text-black transition duration-300">
                Katalog
            </button>
            
            <div id="auth-box">
                <div id="g_id_onload"
                    data-client_id="502358231350-pr4t7jj775ckcu64n8stfeq6qkesjr15.apps.googleusercontent.com"
                    data-callback="handleCredentialResponse"
                    data-auto_prompt="false">
                </div>
                <div class="g_id_signin" 
                    data-type="standard" 
                    data-shape="pill" 
                    data-theme="filled_black" 
                    data-text="signin_with" 
                    data-size="small" 
                    data-logo_alignment="left">
                </div>
            </div>
        </div>
    </nav>

    <main id="content" class="max-w-7xl mx-auto p-6 min-h-screen"></main>

    <script>
        // Fungsi Handle Login Google
        function handleCredentialResponse(response) {
            try {
                // Mendekode JWT Payload
                const base64Url = response.credential.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                const payload = JSON.parse(window.atob(base64));
                
                localStorage.setItem('user_nofast', JSON.stringify(payload));
                renderUser(payload);
            } catch (error) {
                console.error("Gagal login:", error);
            }
        }

        // Tampilkan Profil User
        function renderUser(user) {
            document.getElementById('auth-box').innerHTML = `
                <div class="flex items-center gap-2 bg-white/5 p-1 pr-3 rounded-full border border-white/10 animate-fade">
                    <img src="${user.picture}" class="w-7 h-7 rounded-full border border-blue-500/50 shadow-lg">
                    <div class="flex flex-col">
                        <span class="text-[9px] font-black uppercase tracking-tighter leading-none">${user.given_name}</span>
                        <span class="text-[7px] text-gray-500 truncate max-w-[60px]">${user.email}</span>
                    </div>
                    <button onclick="logout()" class="ml-1 text-red-500 text-[10px] hover:scale-110 transition">
                        <i class="fas fa-power-off"></i>
                    </button>
                </div>`;
        }

        // Fungsi Logout
        function logout() {
            localStorage.removeItem('user_nofast');
            location.reload();
        }

        // Fungsi Load Halaman Dinamis
        async function loadPage(page) {
            const contentDiv = document.getElementById('content');
            try {
                const res = await fetch(`pages/${page}.html`);
                if (!res.ok) throw new Error('Not Found');
                
                const html = await res.text();
                contentDiv.innerHTML = `<div class="animate-fade">${html}</div>`;
                
                // Re-eksekusi script di halaman yang di-load
                const scripts = contentDiv.querySelectorAll('script');
                scripts.forEach(oldScript => {
                    const newScript = document.createElement("script");
                    newScript.text = oldScript.innerText;
                    document.body.appendChild(newScript).parentNode.removeChild(newScript);
                });
            } catch (e) { 
                contentDiv.innerHTML = `
                <div class="flex flex-col items-center justify-center mt-20 opacity-50">
                    <i class="fas fa-ghost text-4xl mb-4"></i>
                    <p class="font-bold tracking-widest text-xs uppercase">Halaman "${page}" Belum Dibuat</p>
                </div>`;
            }
        }

        // Inisialisasi
        window.onload = () => {
            const savedUser = localStorage.getItem('user_nofast');
            if (savedUser) {
                renderUser(JSON.parse(savedUser));
            }
            loadPage('beranda');
        };
    </script>
</body>
</html>

